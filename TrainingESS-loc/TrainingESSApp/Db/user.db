record(ao, "zoven:circle:step") {
  field(VAL , "1.0")
  field(DRVL, "0.0")
  field(DRVH, "359")
  field(PINI, "YES")
}

record(ao, "zoven:circle:period") {
  field(VAL , "1.0")
  field(PINI, "YES")
  field(OUT , "zoven:circle:tick.ODLY NPP")
}

record(calc, "zoven:circle:angle") {
  field(PINI, "RUNNING") # bootstrap
  field(INPA, "zoven:circle:angle NPP")
  field(INPB, "zoven:circle:step NPP")
  field(INPD, "360")
  field(DESC, "Angle")
  field(EGU , "deg")
  field(LOLO, "45")
  field(LOW , "135")
  field(HIGH, "225")
  field(HIHI, "315")
  field(LLSV, "MAJOR")
  field(LSV , "MINOR")
  field(HSV , "MINOR")
  field(HHSV, "MAJOR")
  field(CALC, "C:=A+B;(C>=D)?C-D:C")
  field(FLNK, "zoven:circle:x")
  field(PREC, "3")
  info(Q:group, {
      "zoven:circle":{"angle": {+channel:"VAL"}},
      "zoven:line":{"a": {+channel:"VAL"}}
  })
  alias("zoven:line:a")
}

record(calc, "zoven:circle:x") {
  field(INPA, "zoven:circle:angle NPP")
  field(CALC, "cos(A*PI/180)")
  field(TSEL, "zoven:circle:angle.TIME")
  field(FLNK, "zoven:circle:y")
  field(PREC, "3")
  info(Q:group, {
      "zoven:circle":{"x": {+channel:"VAL"}}
  })
}

record(calc, "zoven:circle:y") {
  field(INPA, "zoven:circle:angle NPP")
  field(CALC, "sin(A*PI/180)")
  field(TSEL, "zoven:circle:angle.TIME")
  field(PREC, "3")
  field(FLNK, "zoven:line:b")
  info(Q:group, {
      "zoven:circle":{"y": {+channel:"VAL", +trigger:"*"}}
  })
}

record(ai, "zoven:line:b") {
  field(INP, "zoven:line:a NPP")
  field(FLNK, "zoven:circle:tick")
  info(Q:group, {
      "zoven:line":{"b": {+channel:"VAL", +trigger:"*"}}
  })
}

record(calcout, "zoven:circle:tick") {
  field(ODLY, "1.0")
  field(OUT , "zoven:circle:angle.PROC CA") # loop
}
record(ai, "zoven:aiExample")
{
	field(DESC, "Analog input")
	field(INP, "zoven:calcExample.VAL  NPP NMS")
	field(EGUF, "10")
	field(EGU, "Counts")
	field(HOPR, "10")
	field(LOPR, "0")
	field(HIHI, "8")
	field(HIGH, "6")
	field(LOW, "4")
	field(LOLO, "2")
	field(HHSV, "MAJOR")
	field(HSV, "MINOR")
	field(LSV, "MINOR")
	field(LLSV, "MAJOR")
}
record(calc, "zoven:calcExample")
{
	field(DESC, "Counter")
	field(SCAN,"1 second")
	field(FLNK, "zoven:aiExample")
	field(CALC, "(A<B)?(A+C):D")
	field(INPA, "zoven:calcExample.VAL  NPP NMS")
	field(INPB, "9")
	field(INPC, "1")
	field(INPD, "0")
	field(EGU, "Counts")
	field(HOPR, "10")
	field(HIHI, "8")
	field(HIGH, "6")
	field(LOW, "4")
	field(LOLO, "2")
	field(HHSV, "MAJOR")
	field(HSV, "MINOR")
	field(LSV, "MINOR")
	field(LLSV, "MAJOR")
}
record(xxx, "zoven:xxxExample")
{
	field(DESC, "xxx record")
	field(EGU, "Counts")
	field(HOPR, "10")
	field(HIHI, "8")
	field(HIGH, "6")
	field(LOW, "4")
	field(LOLO, "2")
	field(HHSV, "MAJOR")
	field(HSV, "MINOR")
	field(LSV, "MINOR")
	field(LLSV, "MAJOR")
}
record(compress,"zoven:compressExample")
{
	field(DESC, "Circular buffer")
	field(INP,"zoven:aiExample.VAL CP NMS")
	field(ALG,"Circular Buffer")
	field(NSAM,"10")
	field(HOPR,"10")
	field(EGU,"Counts")
}

record(calc, "zoven:calcExample1")
{
	alias("zoven:calc1")
	field(DESC, "Counter No. 1")
	field(SCAN,"1 second")
	field(FLNK, "zoven:aiExample1")
	field(CALC, "(A<B)?(A+C):D")
	field(INPA, "zoven:calcExample1.VAL NPP NMS")
	field(INPB, "9")
	field(INPC, "1")
	field(INPD, "0")
	field(EGU, "Counts")
	field(HOPR, "10")
	field(HIHI, "8")
	field(HIGH, "6")
	field(LOW, "4")
	field(LOLO, "2")
	field(HHSV, "MAJOR")
	field(HSV, "MINOR")
	field(LSV, "MINOR")
	field(LLSV, "MAJOR")
}
record(ai, "zoven:aiExample1")
{
	field(DESC, "Analog input No. 1")
	field(INP, "zoven:calcExample1.VAL NPP NMS")
	field(EGUF, "10")
	field(EGU, "Counts")
	field(HOPR, "10")
	field(LOPR, "0")
	field(HIHI, "8")
	field(HIGH, "6")
	field(LOW, "4")
	field(LOLO, "2")
	field(HHSV, "MAJOR")
	field(HSV, "MINOR")
	field(LSV, "MINOR")
	field(LLSV, "MAJOR")
}
alias("zoven:aiExample1","zoven:ai1")
record(calc, "zoven:calcExample2")
{
	alias("zoven:calc2")
	field(DESC, "Counter No. 2")
	field(SCAN,"2 second")
	field(FLNK, "zoven:aiExample2")
	field(CALC, "(A<B)?(A+C):D")
	field(INPA, "zoven:calcExample2.VAL NPP NMS")
	field(INPB, "9")
	field(INPC, "1")
	field(INPD, "0")
	field(EGU, "Counts")
	field(HOPR, "10")
	field(HIHI, "8")
	field(HIGH, "6")
	field(LOW, "4")
	field(LOLO, "2")
	field(HHSV, "MAJOR")
	field(HSV, "MINOR")
	field(LSV, "MINOR")
	field(LLSV, "MAJOR")
}
record(ai, "zoven:aiExample2")
{
	field(DESC, "Analog input No. 2")
	field(INP, "zoven:calcExample2.VAL NPP NMS")
	field(EGUF, "10")
	field(EGU, "Counts")
	field(HOPR, "10")
	field(LOPR, "0")
	field(HIHI, "8")
	field(HIGH, "6")
	field(LOW, "4")
	field(LOLO, "2")
	field(HHSV, "MAJOR")
	field(HSV, "MINOR")
	field(LSV, "MINOR")
	field(LLSV, "MAJOR")
}
alias("zoven:aiExample2","zoven:ai2")
record(calc, "zoven:calcExample3")
{
	alias("zoven:calc3")
	field(DESC, "Counter No. 3")
	field(SCAN,"5 second")
	field(FLNK, "zoven:aiExample3")
	field(CALC, "(A<B)?(A+C):D")
	field(INPA, "zoven:calcExample3.VAL NPP NMS")
	field(INPB, "9")
	field(INPC, "1")
	field(INPD, "0")
	field(EGU, "Counts")
	field(HOPR, "10")
	field(HIHI, "8")
	field(HIGH, "6")
	field(LOW, "4")
	field(LOLO, "2")
	field(HHSV, "MAJOR")
	field(HSV, "MINOR")
	field(LSV, "MINOR")
	field(LLSV, "MAJOR")
}
record(ai, "zoven:aiExample3")
{
	field(DESC, "Analog input No. 3")
	field(INP, "zoven:calcExample3.VAL NPP NMS")
	field(EGUF, "10")
	field(EGU, "Counts")
	field(HOPR, "10")
	field(LOPR, "0")
	field(HIHI, "8")
	field(HIGH, "6")
	field(LOW, "4")
	field(LOLO, "2")
	field(HHSV, "MAJOR")
	field(HSV, "MINOR")
	field(LSV, "MINOR")
	field(LLSV, "MAJOR")
}
alias("zoven:aiExample3","zoven:ai3")
